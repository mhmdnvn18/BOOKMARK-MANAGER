<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DevBookmarks - Professional Resource Hub</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Hero Section -->
    <header class="hero-section">
        <div class="container">
            <h1 class="display-4 fw-bold mb-3">DevBookmarks</h1>
            <p class="lead mb-4">Curated collection of development resources</p>
            <div class="search-bar">
                <input type="text" class="form-control border-0 bg-transparent text-white" 
                       placeholder="Search bookmarks...">
            </div>
        </div>
    </header>

    <main class="container">
        <!-- Add Bookmark Form (Visible to Admin) -->
        <div class="glass-card mb-5 p-4" id="add-bookmark">
            <h2 class="h4">Add Bookmark</h2>
            <form id="bookmark-form" class="form">
                <div class="form-group">
                    <label for="title">Title</label>
                    <input type="text" id="title" class="form-control" placeholder="Title" required>
                </div>
                <div class="form-group">
                    <label for="url">URL</label>
                    <input type="url" id="url" class="form-control" placeholder="URL" required>
                </div>
                <div class="form-group">
                    <label for="category">Category</label>
                    <select id="category" class="form-control" required>
                        <option value="" disabled selected>Select Category</option>
                        <option value="Work">Work</option>
                        <option value="Personal">Personal</option>
                        <option value="Education">Education</option>
                        <option value="Entertainment">Entertainment</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Add Bookmark</button>
            </form>
        </div>

        <!-- Bookmarks Grid -->
        <div class="row g-4" id="bookmarks-grid">
            <!-- Dynamic Content -->
            <div class="col-lg-4 col-md-6">
                <div class="bookmark-card glass-card">
                    <div class="category-chip">Tools</div>
                    <div class="mb-3">
                        <i class="fab fa-codepen fa-2x text-primary"></i>
                    </div>
                    <h3 class="h5 mb-2">CodePen</h3>
                    <p class="text-muted mb-3">Online code editor and front-end web development learning environment</p>
                    <a href="https://codepen.io" class="btn btn-sm btn-outline-primary" target="_blank">
                        Visit Site <i class="fas fa-external-link-alt ms-2"></i>
                    </a>
                    <div class="bookmark-actions">
                        <button class="btn btn-sm btn-light me-2">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-light">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Edit Modal -->
    <div class="modal fade" id="editModal">
        <!-- Modal content -->
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-app.js";
        import { getFirestore, collection, getDocs, addDoc, doc, deleteDoc, updateDoc, getDoc } from "https://www.gstatic.com/firebasejs/11.4.0/firebase-firestore.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDSyI1drQSWkU1192Ol_7UnOztxxTZkerQ",
            authDomain: "bookmark-manager-7c5ab.firebaseapp.com",
            projectId: "bookmark-manager-7c5ab",
            storageBucket: "bookmark-manager-7c5ab.firebasestorage.app",
            messagingSenderId: "1098246411927",
            appId: "1:1098246411927:web:9a44915017f9d35fbefbd2",
            measurementId: "G-YF6CS3N1C6"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('bookmark-form');
            const editForm = document.getElementById('edit-bookmark-form');
            const bookmarkList = document.getElementById('bookmark-list');
            const themeToggle = document.getElementById('theme-toggle');
            let editIndex = null;

            async function displayBookmarks() {
                bookmarkList.innerHTML = '';
                const querySnapshot = await getDocs(collection(db, 'bookmarks'));
                const categories = {};
                querySnapshot.forEach((doc) => {
                    const bookmark = doc.data();
                    if (!categories[bookmark.category]) {
                        categories[bookmark.category] = [];
                    }
                    categories[bookmark.category].push({ ...bookmark, id: doc.id });
                });

                const categoryContainer = document.createElement('div');
                categoryContainer.classList.add('category-container');

                for (const category in categories) {
                    const categorySection = document.createElement('div');
                    categorySection.classList.add('category-section');
                    categorySection.innerHTML = `<h3 class="category-title">${category} (${categories[category].length})</h3>`;

                    categories[category].forEach(bookmark => {
                        const categoryClass = `card-header-${bookmark.category.toLowerCase()}`;
                        const bookmarkElement = document.createElement('div');
                        bookmarkElement.classList.add('card', 'text-bg-primary', 'mb-3');
                        bookmarkElement.style.maxWidth = '18rem';
                        bookmarkElement.innerHTML = `
                            <div class="card-header ${categoryClass}">${category}</div>
                            <div class="card-body">
                                <h5 class="card-title">${bookmark.title}</h5>
                                <p class="card-text">
                                    <a href="${bookmark.url}" class="bookmark-url" target="_blank">${bookmark.url}</a>
                                </p>
                                <p class="card-text">
                                    <span class="bookmark-category">${bookmark.category}</span>
                                </p>
                                <button class="edit btn btn-warning" onclick="editBookmark('${bookmark.id}')">Edit</button>
                                <button class="btn btn-danger" onclick="deleteBookmark('${bookmark.id}')">Delete</button>
                            </div>
                        `;
                        categorySection.appendChild(bookmarkElement);
                    });

                    categoryContainer.appendChild(categorySection);
                }

                bookmarkList.appendChild(categoryContainer);
            }

            window.deleteBookmark = async function(id) {
                await deleteDoc(doc(db, 'bookmarks', id));
                displayBookmarks();
            }

            window.editBookmark = async function(id) {
                editIndex = id;
                const docSnap = await getDoc(doc(db, 'bookmarks', id));
                const bookmark = docSnap.data();
                document.getElementById('edit-title').value = bookmark.title;
                document.getElementById('edit-url').value = bookmark.url;
                document.getElementById('edit-category').value = bookmark.category;
                document.getElementById('edit-bookmark').style.display = 'block';
            }

            editForm.addEventListener('submit', async function(event) {
                event.preventDefault();
                const title = document.getElementById('edit-title').value;
                const url = document.getElementById('edit-url').value;
                const category = document.getElementById('edit-category').value;
                await updateDoc(doc(db, 'bookmarks', editIndex), { title, url, category });
                displayBookmarks();
                editForm.reset();
                document.getElementById('edit-bookmark').style.display = 'none';
            });

            form.addEventListener('submit', async function(event) {
                event.preventDefault();
                const title = document.getElementById('title').value;
                const url = document.getElementById('url').value;
                const category = document.getElementById('category').value;
                console.log('Adding bookmark:', { title, url, category });
                try {
                    await addDoc(collection(db, 'bookmarks'), { title, url, category });
                    console.log('Bookmark added successfully');
                    displayBookmarks();
                    form.reset();
                } catch (error) {
                    console.error('Error adding bookmark:', error);
                }
            });

            window.logout = function() {
                localStorage.removeItem('loggedIn');
                window.location.href = 'login.html';
            }

            themeToggle.addEventListener('click', function() {
                document.body.classList.toggle('dark-mode');
                localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
            });

            if (localStorage.getItem('theme') === 'dark') {
                document.body.classList.add('dark-mode');
            }

            displayBookmarks();
        });
    </script>
</body>
</html>